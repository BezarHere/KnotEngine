//#include "pch.h"
#include "utility/Error.h"

#define ERROR_ENTRY(err) case err: return #err
#define ERROR_ENTRY_V(err, offset) case err: return &(#err)[offset]

const char *_GetErrorName(const errno_t error_code) {
	enum { template_str_size = 20, hex_radix = 16 };
	static char template_str[template_str_size] = {'0', 'x'};
	switch (error_code)
	{
		ERROR_ENTRY_V(EPERM, 1);
		ERROR_ENTRY_V(ENOENT, 1);
		ERROR_ENTRY_V(ESRCH, 1);
		ERROR_ENTRY_V(EINTR, 1);
		ERROR_ENTRY_V(EIO, 1);
		ERROR_ENTRY_V(ENXIO, 1);
		ERROR_ENTRY_V(E2BIG, 1);
		ERROR_ENTRY_V(ENOEXEC, 1);
		ERROR_ENTRY_V(EBADF, 1);
		ERROR_ENTRY_V(ECHILD, 1);
		ERROR_ENTRY_V(EAGAIN, 1);
		ERROR_ENTRY_V(ENOMEM, 1);
		ERROR_ENTRY_V(EACCES, 1);
		ERROR_ENTRY_V(EFAULT, 1);
		ERROR_ENTRY_V(EBUSY, 1);
		ERROR_ENTRY_V(EEXIST, 1);
		ERROR_ENTRY_V(EXDEV, 1);
		ERROR_ENTRY_V(ENODEV, 1);
		ERROR_ENTRY_V(ENOTDIR, 1);
		ERROR_ENTRY_V(EISDIR, 1);
		ERROR_ENTRY_V(ENFILE, 1);
		ERROR_ENTRY_V(EMFILE, 1);
		ERROR_ENTRY_V(ENOTTY, 1);
		ERROR_ENTRY_V(EFBIG, 1);
		ERROR_ENTRY_V(ENOSPC, 1);
		ERROR_ENTRY_V(ESPIPE, 1);
		ERROR_ENTRY_V(EROFS, 1);
		ERROR_ENTRY_V(EMLINK, 1);
		ERROR_ENTRY_V(EPIPE, 1);
		ERROR_ENTRY_V(EDOM, 1);
		ERROR_ENTRY_V(EDEADLK, 1);
		ERROR_ENTRY_V(ENAMETOOLONG, 1);
		ERROR_ENTRY_V(ENOLCK, 1);
		ERROR_ENTRY_V(ENOSYS, 1);
		ERROR_ENTRY_V(ENOTEMPTY, 1);
		ERROR_ENTRY_V(EINVAL, 1);
		ERROR_ENTRY_V(ERANGE, 1);
		ERROR_ENTRY_V(EILSEQ, 1);
		ERROR_ENTRY_V(STRUNCATE, 1);
		ERROR_ENTRY_V(ENOTSUP, 1);
		ERROR_ENTRY_V(EAFNOSUPPORT, 1);
		ERROR_ENTRY_V(EADDRINUSE, 1);
		ERROR_ENTRY_V(EADDRNOTAVAIL, 1);
		ERROR_ENTRY_V(EISCONN, 1);
		ERROR_ENTRY_V(ENOBUFS, 1);
		ERROR_ENTRY_V(ECONNABORTED, 1);
		ERROR_ENTRY_V(EALREADY, 1);
		ERROR_ENTRY_V(ECONNREFUSED, 1);
		ERROR_ENTRY_V(ECONNRESET, 1);
		ERROR_ENTRY_V(EDESTADDRREQ, 1);
		ERROR_ENTRY_V(EHOSTUNREACH, 1);
		ERROR_ENTRY_V(EMSGSIZE, 1);
		ERROR_ENTRY_V(ENETDOWN, 1);
		ERROR_ENTRY_V(ENETRESET, 1);
		ERROR_ENTRY_V(ENETUNREACH, 1);
		ERROR_ENTRY_V(ENOPROTOOPT, 1);
		ERROR_ENTRY_V(ENOTSOCK, 1);
		ERROR_ENTRY_V(ENOTCONN, 1);
		ERROR_ENTRY_V(ECANCELED, 1);
		ERROR_ENTRY_V(EINPROGRESS, 1);
		ERROR_ENTRY_V(EOPNOTSUPP, 1);
		ERROR_ENTRY_V(EWOULDBLOCK, 1);
		ERROR_ENTRY_V(EOWNERDEAD, 1);
		ERROR_ENTRY_V(EPROTO, 1);
		ERROR_ENTRY_V(EPROTONOSUPPORT, 1);
		ERROR_ENTRY_V(EBADMSG, 1);
		ERROR_ENTRY_V(EIDRM, 1);
		ERROR_ENTRY_V(ENODATA, 1);
		ERROR_ENTRY_V(ENOLINK, 1);
		ERROR_ENTRY_V(ENOMSG, 1);
		ERROR_ENTRY_V(ENOSR, 1);
		ERROR_ENTRY_V(ENOSTR, 1);
		ERROR_ENTRY_V(ENOTRECOVERABLE, 1);
		ERROR_ENTRY_V(ETIME, 1);
		ERROR_ENTRY_V(ETXTBSY, 1);
		ERROR_ENTRY_V(ETIMEDOUT, 1);
		ERROR_ENTRY_V(ELOOP, 1);
		ERROR_ENTRY_V(EPROTOTYPE, 1);
		ERROR_ENTRY_V(EOVERFLOW, 1);

#ifdef _WINDOWS_
		ERROR_ENTRY(E_UNEXPECTED);
		ERROR_ENTRY(E_NOTIMPL);
		ERROR_ENTRY(E_OUTOFMEMORY);
		ERROR_ENTRY(E_INVALIDARG);
		ERROR_ENTRY(E_NOINTERFACE);
		ERROR_ENTRY(E_POINTER);
		ERROR_ENTRY(E_HANDLE);
		ERROR_ENTRY(E_ABORT);
		ERROR_ENTRY(E_FAIL);
		ERROR_ENTRY(E_ACCESSDENIED);
		ERROR_ENTRY(E_PENDING);
		ERROR_ENTRY(E_NOT_SUFFICIENT_BUFFER);
		
		ERROR_ENTRY(CO_E_INIT_TLS);
		ERROR_ENTRY(CO_E_INIT_SHARED_ALLOCATOR);
		ERROR_ENTRY(CO_E_INIT_MEMORY_ALLOCATOR);
		ERROR_ENTRY(CO_E_INIT_CLASS_CACHE);
		ERROR_ENTRY(CO_E_INIT_RPC_CHANNEL);
		ERROR_ENTRY(CO_E_INIT_TLS_SET_CHANNEL_CONTROL);
		ERROR_ENTRY(CO_E_INIT_TLS_CHANNEL_CONTROL);
		ERROR_ENTRY(CO_E_INIT_UNACCEPTED_USER_ALLOCATOR);
		ERROR_ENTRY(CO_E_INIT_SCM_MUTEX_EXISTS);
		ERROR_ENTRY(CO_E_INIT_SCM_FILE_MAPPING_EXISTS);
		ERROR_ENTRY(CO_E_INIT_SCM_MAP_VIEW_OF_FILE);
		ERROR_ENTRY(CO_E_INIT_SCM_EXEC_FAILURE);
		ERROR_ENTRY(CO_E_INIT_ONLY_SINGLE_THREADED);
		ERROR_ENTRY(CO_E_CANT_REMOTE);
		ERROR_ENTRY(CO_E_BAD_SERVER_NAME);
		ERROR_ENTRY(CO_E_WRONG_SERVER_IDENTITY);
		ERROR_ENTRY(CO_E_OLE1DDE_DISABLED);
		ERROR_ENTRY(CO_E_RUNAS_SYNTAX);
		ERROR_ENTRY(CO_E_CREATEPROCESS_FAILURE);
		ERROR_ENTRY(CO_E_RUNAS_CREATEPROCESS_FAILURE);
		ERROR_ENTRY(CO_E_RUNAS_LOGON_FAILURE);
		ERROR_ENTRY(CO_E_LAUNCH_PERMSSION_DENIED);
		ERROR_ENTRY(CO_E_START_SERVICE_FAILURE);
		ERROR_ENTRY(CO_E_REMOTE_COMMUNICATION_FAILURE);
		ERROR_ENTRY(CO_E_SERVER_START_TIMEOUT);
		ERROR_ENTRY(CO_E_CLSREG_INCONSISTENT);
		ERROR_ENTRY(CO_E_IIDREG_INCONSISTENT);
		ERROR_ENTRY(CO_E_NOT_SUPPORTED);
		ERROR_ENTRY(CO_E_RELOAD_DLL);
		ERROR_ENTRY(CO_E_MSI_ERROR);
		ERROR_ENTRY(CO_E_ATTEMPT_TO_CREATE_OUTSIDE_CLIENT_CONTEXT);
		ERROR_ENTRY(CO_E_SERVER_PAUSED);
		ERROR_ENTRY(CO_E_SERVER_NOT_PAUSED);
		ERROR_ENTRY(CO_E_CLASS_DISABLED);
		ERROR_ENTRY(CO_E_CLRNOTAVAILABLE);
		ERROR_ENTRY(CO_E_ASYNC_WORK_REJECTED);
		ERROR_ENTRY(CO_E_SERVER_INIT_TIMEOUT);
		ERROR_ENTRY(CO_E_NO_SECCTX_IN_ACTIVATE);
		ERROR_ENTRY(CO_E_TRACKER_CONFIG);
		ERROR_ENTRY(CO_E_THREADPOOL_CONFIG);
		ERROR_ENTRY(CO_E_SXS_CONFIG);
		ERROR_ENTRY(CO_E_MALFORMED_SPN);
		ERROR_ENTRY(OLE_E_FIRST);
		ERROR_ENTRY(OLE_E_LAST);
		// ERROR_ENTRY(OLE_E_OLEVERB);
		ERROR_ENTRY(OLE_E_ADVF);
		ERROR_ENTRY(OLE_E_ENUM_NOMORE);
		ERROR_ENTRY(OLE_E_ADVISENOTSUPPORTED);
		ERROR_ENTRY(OLE_E_NOCONNECTION);
		ERROR_ENTRY(OLE_E_NOTRUNNING);
		ERROR_ENTRY(OLE_E_NOCACHE);
		ERROR_ENTRY(OLE_E_BLANK);
		ERROR_ENTRY(OLE_E_CLASSDIFF);
		ERROR_ENTRY(OLE_E_CANT_GETMONIKER);
		ERROR_ENTRY(OLE_E_CANT_BINDTOSOURCE);
		ERROR_ENTRY(OLE_E_STATIC);
		ERROR_ENTRY(OLE_E_PROMPTSAVECANCELLED);
		ERROR_ENTRY(OLE_E_INVALIDRECT);
		ERROR_ENTRY(OLE_E_WRONGCOMPOBJ);
		ERROR_ENTRY(OLE_E_INVALIDHWND);
		ERROR_ENTRY(OLE_E_NOT_INPLACEACTIVE);
		ERROR_ENTRY(OLE_E_CANTCONVERT);
		ERROR_ENTRY(OLE_E_NOSTORAGE);
		ERROR_ENTRY(DV_E_FORMATETC);
		ERROR_ENTRY(DV_E_DVTARGETDEVICE);
		ERROR_ENTRY(DV_E_STGMEDIUM);
		ERROR_ENTRY(DV_E_STATDATA);
		ERROR_ENTRY(DV_E_LINDEX);
		ERROR_ENTRY(DV_E_TYMED);
		ERROR_ENTRY(DV_E_CLIPFORMAT);
		ERROR_ENTRY(DV_E_DVASPECT);
		ERROR_ENTRY(DV_E_DVTARGETDEVICE_SIZE);
		ERROR_ENTRY(DV_E_NOIVIEWOBJECT);
		ERROR_ENTRY(DRAGDROP_E_FIRST);
		ERROR_ENTRY(DRAGDROP_E_LAST);
		// ERROR_ENTRY(DRAGDROP_E_NOTREGISTERED);
		ERROR_ENTRY(DRAGDROP_E_ALREADYREGISTERED);
		ERROR_ENTRY(DRAGDROP_E_INVALIDHWND);
		ERROR_ENTRY(CLASSFACTORY_E_FIRST);
		ERROR_ENTRY(CLASSFACTORY_E_LAST);
		// ERROR_ENTRY(CLASS_E_NOAGGREGATION);
		ERROR_ENTRY(CLASS_E_NOTLICENSED);
		ERROR_ENTRY(CLASS_E_CLASSNOTAVAILABLE);
#endif

#ifdef _WINSOCKAPI_
		ERROR_ENTRY(WSABASEERR);
		ERROR_ENTRY(WSAEINTR);
		ERROR_ENTRY(WSAEBADF);
		ERROR_ENTRY(WSAEACCES);
		ERROR_ENTRY(WSAEFAULT);
		ERROR_ENTRY(WSAEINVAL);
		ERROR_ENTRY(WSAEMFILE);
		ERROR_ENTRY(WSAEWOULDBLOCK);
		ERROR_ENTRY(WSAEINPROGRESS);
		ERROR_ENTRY(WSAEALREADY);
		ERROR_ENTRY(WSAENOTSOCK);
		ERROR_ENTRY(WSAEDESTADDRREQ);
		ERROR_ENTRY(WSAEMSGSIZE);
		ERROR_ENTRY(WSAEPROTOTYPE);
		ERROR_ENTRY(WSAENOPROTOOPT);
		ERROR_ENTRY(WSAEPROTONOSUPPORT);
		ERROR_ENTRY(WSAESOCKTNOSUPPORT);
		ERROR_ENTRY(WSAEOPNOTSUPP);
		ERROR_ENTRY(WSAEPFNOSUPPORT);
		ERROR_ENTRY(WSAEAFNOSUPPORT);
		ERROR_ENTRY(WSAEADDRINUSE);
		ERROR_ENTRY(WSAEADDRNOTAVAIL);
		ERROR_ENTRY(WSAENETDOWN);
		ERROR_ENTRY(WSAENETUNREACH);
		ERROR_ENTRY(WSAENETRESET);
		ERROR_ENTRY(WSAECONNABORTED);
		ERROR_ENTRY(WSAECONNRESET);
		ERROR_ENTRY(WSAENOBUFS);
		ERROR_ENTRY(WSAEISCONN);
		ERROR_ENTRY(WSAENOTCONN);
		ERROR_ENTRY(WSAESHUTDOWN);
		ERROR_ENTRY(WSAETOOMANYREFS);
		ERROR_ENTRY(WSAETIMEDOUT);
		ERROR_ENTRY(WSAECONNREFUSED);
		ERROR_ENTRY(WSAELOOP);
		ERROR_ENTRY(WSAENAMETOOLONG);
		ERROR_ENTRY(WSAEHOSTDOWN);
		ERROR_ENTRY(WSAEHOSTUNREACH);
		ERROR_ENTRY(WSAENOTEMPTY);
		ERROR_ENTRY(WSAEPROCLIM);
		ERROR_ENTRY(WSAEUSERS);
		ERROR_ENTRY(WSAEDQUOT);
		ERROR_ENTRY(WSAESTALE);
		ERROR_ENTRY(WSAEREMOTE);
		ERROR_ENTRY(WSASYSNOTREADY);
		ERROR_ENTRY(WSAVERNOTSUPPORTED);
		ERROR_ENTRY(WSANOTINITIALISED);
		ERROR_ENTRY(WSAEDISCON);
		ERROR_ENTRY(WSAENOMORE);
		ERROR_ENTRY(WSAECANCELLED);
		ERROR_ENTRY(WSAEINVALIDPROCTABLE);
		ERROR_ENTRY(WSAEINVALIDPROVIDER);
		ERROR_ENTRY(WSAEPROVIDERFAILEDINIT);
		ERROR_ENTRY(WSASYSCALLFAILURE);
		ERROR_ENTRY(WSASERVICE_NOT_FOUND);
		ERROR_ENTRY(WSATYPE_NOT_FOUND);
		ERROR_ENTRY(WSA_E_NO_MORE);
		ERROR_ENTRY(WSA_E_CANCELLED);
		ERROR_ENTRY(WSAEREFUSED);
		ERROR_ENTRY(WSAHOST_NOT_FOUND);
		ERROR_ENTRY(WSATRY_AGAIN);
		ERROR_ENTRY(WSANO_RECOVERY);
		ERROR_ENTRY(WSANO_DATA);
		ERROR_ENTRY(WSA_QOS_RECEIVERS);
		ERROR_ENTRY(WSA_QOS_SENDERS);
		ERROR_ENTRY(WSA_QOS_NO_SENDERS);
		ERROR_ENTRY(WSA_QOS_NO_RECEIVERS);
		ERROR_ENTRY(WSA_QOS_REQUEST_CONFIRMED);
		ERROR_ENTRY(WSA_QOS_ADMISSION_FAILURE);
		ERROR_ENTRY(WSA_QOS_POLICY_FAILURE);
		ERROR_ENTRY(WSA_QOS_BAD_STYLE);
		ERROR_ENTRY(WSA_QOS_BAD_OBJECT);
		ERROR_ENTRY(WSA_QOS_TRAFFIC_CTRL_ERROR);
		ERROR_ENTRY(WSA_QOS_GENERIC_ERROR);
		ERROR_ENTRY(WSA_QOS_ESERVICETYPE);
		ERROR_ENTRY(WSA_QOS_EFLOWSPEC);
		ERROR_ENTRY(WSA_QOS_EPROVSPECBUF);
		ERROR_ENTRY(WSA_QOS_EFILTERSTYLE);
		ERROR_ENTRY(WSA_QOS_EFILTERTYPE);
		ERROR_ENTRY(WSA_QOS_EFILTERCOUNT);
		ERROR_ENTRY(WSA_QOS_EOBJLENGTH);
		ERROR_ENTRY(WSA_QOS_EFLOWCOUNT);
		ERROR_ENTRY(WSA_QOS_EUNKNOWNPSOBJ);
		// ERROR_ENTRY(WSA_QOS_EUNKOWNPSOBJ);
		ERROR_ENTRY(WSA_QOS_EPOLICYOBJ);
		ERROR_ENTRY(WSA_QOS_EFLOWDESC);
		ERROR_ENTRY(WSA_QOS_EPSFLOWSPEC);
		ERROR_ENTRY(WSA_QOS_EPSFILTERSPEC);
		ERROR_ENTRY(WSA_QOS_ESDMODEOBJ);
		ERROR_ENTRY(WSA_QOS_ESHAPERATEOBJ);
		ERROR_ENTRY(WSA_QOS_RESERVED_PETYPE);
#endif
	default:

		for (size_t i = 0; i < (sizeof(error_code) * 2); i++)
		{
			if ((error_code >> (i * 4)) == 0)
			{
				template_str[i] = 0;
				break;
			}

			template_str[i + 2] = "0123456789ABCDEF"[(error_code >> (i * 4)) & (hex_radix - 1)];
		}

		return template_str;
	}
}

